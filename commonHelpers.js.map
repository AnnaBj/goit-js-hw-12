{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst lightBox = new SimpleLightbox('.gallery-link');\n\nconst formElement = document.querySelector('.form');\nconst galleryElement = document.querySelector('.gallery');\nconst loaderElement = document.querySelector('.loader');\nconst loadBtnElement = document.querySelector('.more');\n\nlet currentPage = 1;\nlet itemsPerPage = 15;\nlet currentSearchQuery;\nloadBtnElement.style.display = 'none';\nloaderElement.style.display = 'none';\n\nasync function fetchImages(searchQuery, page) {\n  const queryParams = {\n    key: '42296556-10e657c6d09903018112d9d9d',\n    q: searchQuery,\n    page,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: itemsPerPage,\n  };\n  const urlParams = new URLSearchParams(queryParams);\n  const { data } = await axios.get(`https://pixabay.com/api/?${urlParams}`);\n  return data;\n}\n\nformElement.addEventListener('submit', async e => {\n  e.preventDefault();\n  currentPage = 1;\n  loadBtnElement.style.display = 'none';\n  galleryElement.innerHTML = '';\n  currentSearchQuery = formElement.elements.search.value.trim();\n  if (currentSearchQuery === '') {\n    iziToast.show({\n      message: 'Please write search image',\n      messageColor: '#FAFAFB',\n      backgroundColor: '#EF4040',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  loaderElement.style.display = 'inline-block';\n  try {\n    const { hits, totalHits } = await fetchImages(\n      currentSearchQuery,\n      currentPage\n    );\n    if (totalHits === 0) {\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        messageColor: '#FAFAFB',\n        backgroundColor: '#EF4040',\n        position: 'topRight',\n      });\n      loaderElement.style.display = 'none';\n      return;\n    }\n    displayImages(hits);\n    if (totalHits < itemsPerPage) {\n      showNotification();\n    } else {\n      loadBtnElement.style.display = 'block';\n    }\n  } catch (error) {\n    iziToast.show({\n      message: `Sorry, ${error}`,\n      messageColor: '#FAFAFB',\n      backgroundColor: '#EF4040',\n      position: 'topRight',\n    });\n  } finally {\n    formElement.reset();\n  }\n});\n\nloadBtnElement.addEventListener('click', async () => {\n  currentPage += 1;\n\n  loaderElement.style.display = 'inline-block';\n  try {\n    const { hits, totalHits } = await fetchImages(\n      currentSearchQuery,\n      currentPage\n    );\n    displayImages(hits);\n    scrollPage();\n    if (itemsPerPage * currentPage > totalHits) {\n      showNotification();\n    }\n  } catch (error) {\n    iziToast.show({\n      message: `Sorry, ${error}`,\n      messageColor: '#FAFAFB',\n      backgroundColor: '#EF4040',\n      position: 'bottomCenter',\n    });\n  }\n});\n\nfunction displayImages(images) {\n  const htmlMarkup = images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" />\n        </a>\n        <div class=\"img-text\">\n          <div class=\"img-info\">\n            <h3>Likes</h3>\n            <p>${likes}</p>\n          </div>\n          <div class=\"img-info\">\n            <h3>Views</h3>\n            <p>${views}</p>\n          </div>\n          <div class=\"img-info\">\n            <h3>Comments</h3>\n            <p>${comments}</p>\n          </div>\n          <div class=\"img-info\">\n            <h3>Downloads</h3>\n            <p>${downloads}</p>\n          </div>\n        </div>\n      </li>\n    `\n    )\n    .join('');\n\n  galleryElement.insertAdjacentHTML('beforeend', htmlMarkup);\n  lightBox.refresh();\n  loaderElement.style.display = 'none';\n}\n\nfunction showNotification() {\n  iziToast.show({\n    message: 'We are sorry, but you have reached the end of search results.',\n    messageColor: '#FAFAFB',\n    backgroundColor: '#1DB8F5',\n    position: 'topRight',\n  });\n  loadBtnElement.style.display = 'none';\n  loaderElement.style.display = 'none';\n}\n\nfunction scrollPage() {\n  const listItem = document.querySelector('.gallery-item');\n  const scrollHeight = listItem.getBoundingClientRect().height * 2;\n  window.scrollBy({\n    top: scrollHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n}"],"names":["lightBox","SimpleLightbox","formElement","galleryElement","loaderElement","loadBtnElement","currentPage","itemsPerPage","currentSearchQuery","fetchImages","searchQuery","page","queryParams","urlParams","data","axios","e","iziToast","hits","totalHits","displayImages","showNotification","error","scrollPage","images","htmlMarkup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","scrollHeight"],"mappings":"owBAMA,MAAMA,EAAW,IAAIC,EAAe,eAAe,EAE7CC,EAAc,SAAS,cAAc,OAAO,EAC5CC,EAAiB,SAAS,cAAc,UAAU,EAClDC,EAAgB,SAAS,cAAc,SAAS,EAChDC,EAAiB,SAAS,cAAc,OAAO,EAErD,IAAIC,EAAc,EACdC,EAAe,GACfC,EACJH,EAAe,MAAM,QAAU,OAC/BD,EAAc,MAAM,QAAU,OAE9B,eAAeK,EAAYC,EAAaC,EAAM,CAC5C,MAAMC,EAAc,CAClB,IAAK,qCACL,EAAGF,EACH,KAAAC,EACA,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUJ,CACd,EACQM,EAAY,IAAI,gBAAgBD,CAAW,EAC3C,CAAE,KAAAE,CAAM,EAAG,MAAMC,EAAM,IAAI,4BAA4BF,CAAS,EAAE,EACxE,OAAOC,CACT,CAEAZ,EAAY,iBAAiB,SAAU,MAAMc,GAAK,CAMhD,GALAA,EAAE,eAAc,EAChBV,EAAc,EACdD,EAAe,MAAM,QAAU,OAC/BF,EAAe,UAAY,GAC3BK,EAAqBN,EAAY,SAAS,OAAO,MAAM,KAAI,EACvDM,IAAuB,GAAI,CAC7BS,EAAS,KAAK,CACZ,QAAS,4BACT,aAAc,UACd,gBAAiB,UACjB,SAAU,UAChB,CAAK,EACD,MACD,CAEDb,EAAc,MAAM,QAAU,eAC9B,GAAI,CACF,KAAM,CAAE,KAAAc,EAAM,UAAAC,CAAW,EAAG,MAAMV,EAChCD,EACAF,CACN,EACI,GAAIa,IAAc,EAAG,CACnBF,EAAS,KAAK,CACZ,QACE,2EACF,aAAc,UACd,gBAAiB,UACjB,SAAU,UAClB,CAAO,EACDb,EAAc,MAAM,QAAU,OAC9B,MACD,CACDgB,EAAcF,CAAI,EACdC,EAAYZ,EACdc,IAEAhB,EAAe,MAAM,QAAU,OAElC,OAAQiB,EAAO,CACdL,EAAS,KAAK,CACZ,QAAS,UAAUK,CAAK,GACxB,aAAc,UACd,gBAAiB,UACjB,SAAU,UAChB,CAAK,CACL,QAAY,CACRpB,EAAY,MAAK,CAClB,CACH,CAAC,EAEDG,EAAe,iBAAiB,QAAS,SAAY,CACnDC,GAAe,EAEfF,EAAc,MAAM,QAAU,eAC9B,GAAI,CACF,KAAM,CAAE,KAAAc,EAAM,UAAAC,CAAW,EAAG,MAAMV,EAChCD,EACAF,CACN,EACIc,EAAcF,CAAI,EAClBK,IACIhB,EAAeD,EAAca,GAC/BE,GAEH,OAAQC,EAAO,CACdL,EAAS,KAAK,CACZ,QAAS,UAAUK,CAAK,GACxB,aAAc,UACd,gBAAiB,UACjB,SAAU,cAChB,CAAK,CACF,CACH,CAAC,EAED,SAASF,EAAcI,EAAQ,CAC7B,MAAMC,EAAaD,EAChB,IACC,CAAC,CACC,cAAAE,EACA,aAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,wCAE4BN,CAAa;AAAA,4CACTC,CAAY,UAAUC,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,iBAKrDC,CAAK;AAAA;AAAA;AAAA;AAAA,iBAILC,CAAK;AAAA;AAAA;AAAA;AAAA,iBAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,iBAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,KAKrB,EACA,KAAK,EAAE,EAEV7B,EAAe,mBAAmB,YAAasB,CAAU,EACzDzB,EAAS,QAAO,EAChBI,EAAc,MAAM,QAAU,MAChC,CAEA,SAASiB,GAAmB,CAC1BJ,EAAS,KAAK,CACZ,QAAS,gEACT,aAAc,UACd,gBAAiB,UACjB,SAAU,UACd,CAAG,EACDZ,EAAe,MAAM,QAAU,OAC/BD,EAAc,MAAM,QAAU,MAChC,CAEA,SAASmB,GAAa,CAEpB,MAAMU,EADW,SAAS,cAAc,eAAe,EACzB,sBAAqB,EAAG,OAAS,EAC/D,OAAO,SAAS,CACd,IAAKA,EACL,KAAM,EACN,SAAU,QACd,CAAG,CACH"}